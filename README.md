# log-reader - Читатель логов

## Описание
**log-reader** позволяет считывать лог файлы. В результате вы получаете массив, содержимое которого вы сами определили.
#### Пример результата
```text
array(2) {
    [0] => object(LogEntity) {
        ["date"]    => "2018-01-01"
        ["time"]    => "15:00:00"
        ["message"] => "log 1"
    }
    [1] => object(LogEntity) {
        ["date"]    => "2018-01-01"
        ["time"]    => "15:00:05"
        ["message"] => "log 2"
    }
}
```
Объект LogEntity это пример, вы можете формировать любой результат, из любых своих объектов.

## Установка
    php composer require lander931/log-reader
    
## Использование
#### Пример исходного лога
    2018-01-01 15:00:00 log 1
    2018-01-01 15:00:05 log 2
### Чтение лога
Передать в **LogReader::read** содержимое файла лога, и функцию разбиения лога на части, функция должна вернуть массив.
```php
$reader = LogReader::read($log_content, function($text) {
    return explode("\n", $text);
})
```
### Фомирование результата
Для формирования результата, используйте ***buildEntries***. На вход, функция принимает текст одной записи лога. В функции вы должны обработать текст одной записи лога, сформировать и вернуть результат в любом виде (например объект или массив).
```php
$reader->buildEntries(function ($log){
    $pattern = "/\[(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}:\d{2})\] (.+)/";
    preg_match_all($pattern, $log, $matches, PREG_SET_ORDER);

    $date = $matches[0][1];
    $time = $matches[0][2];
    $message = $matches[0][3];

    return new LogEntity($date, $time, $message);
});
```
### Получение результата
```php
$res = $reader->getEntries();
```
Если вы не обрабатывали каждую запить лога, то вернётся массив разбитого на частии лога.